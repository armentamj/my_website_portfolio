<% is_sender = local_assigns[:current_user]&.id == message.user_id %>
<% user_class = is_sender ? "me" : "friend" %>
<div id="message_<%= message.id %>" class="<%= user_class %>">
  <%= message.body %>
  <small>
    <%= (message.sent_at || message.created_at).strftime("%m-%d %H:%M") %>
  </small>
  <% if is_sender %>
    <div class="status">
      <% case message.status %>
      <% when 'sent' %>
        <%= content_tag(:span, '✓', class: 'red') %>
      <% when 'delivered' %>
        <%= content_tag(:span, '✓✓', class: 'red') %>
      <% when 'read' %>
        <%= content_tag(:span, '✓✓✓', class: 'red') %>
      <% else %>
        <%= content_tag(:span, 'Status unknown') %>
      <% end %>
    </div>
  <% end %>
</div>
